## 简介

Cortex-M3是一个32位处理器内核。

- 内部的数据路径是32位
- 寄存器是32位
- 存储器接口是32位
- ***地址线是多少位的？？？***

CM3 采用了哈佛结构，拥有独立的指令总线和数据总线，共享同一个存储器空间。比较复杂的应用可能需要**更多的存储系统功能**，为此 CM3 提供一个可选的 MPU，而且在需要 的情况下也可以使用外部的 cache。

***更多的存储系统功能？？***

## 寄存器组

|          R0           |   通用寄存器   |                                                              |
| :-------------------: | :------------: | ------------------------------------------------------------ |
|        **R1**         | **通用寄存器** |                                                              |
|        **R2**         |   通用寄存器   |                                                              |
|        **R3**         |   通用寄存器   |                                                              |
|        **R4**         |   通用寄存器   |                                                              |
|        **R5**         |   通用寄存器   |                                                              |
|        **R6**         |   通用寄存器   |                                                              |
|        **R7**         |   通用寄存器   |                                                              |
|        **R8**         |   通用寄存器   |                                                              |
|        **R9**         |   通用寄存器   |                                                              |
|        **R10**        |   通用寄存器   |                                                              |
|        **R11**        |   通用寄存器   |                                                              |
|        **R12**        |   通用寄存器   | 绝大多数 16 位 Thumb 指令只能访 问 R0‐R7，而 32 位 Thumb‐2 指令可以访问所有寄存器 |
| **R13(MSP)/R13(PSP)** |  **堆栈指针**  | MSP:用于操作系统内核以及异常处理例程;<br />PSP:由用户的应用程序代码使用。<br />**堆栈指针的最低两位永远是 0，这意味着堆栈总是 4 字节对齐的。** |
|        **R14**        | 连接寄存器(LR) | 当调用一个子程序时，由 R14 存储返回地址，无需存于堆栈中，减少内存访问次数 |
|        **R15**        | 程序计数器(PC) | 很多高级技巧就在这里                                         |

## 操作模式和特权级

模式：handler mode/ thread mode

分级：特权级和用户级

一旦进入用 户级，再想回来就得走“法律程序”了——用户级的程序不能简简单单地试图改写 CONTROL 寄存器 就回到特权级，它必须先“申诉”：执行一条系统调用指令(SVC)。这会触发 SVC 异常，然后由异常 服务例程（通常是操作系统的一部分）接管，如果批准了进入，则异常服务例程修改 CONTROL 寄存 器，才能在用户级的线程模式下重新进入特权级。

CONTROL寄存器、SVC异常、异常服务例程

![操作模式转换图](C:\Users\RSheng\Documents\Embedded-development\The Defi nitive Guide to the\操作模式转换图.PNG)

## 内建的嵌套向量中断控制器--NVIC

- 可嵌套中断支持 ——> 优先级对比，xPSR的专用字段
- 向量中断支持 ——> 自动定位向量表，根据中断号找到ISR的入口地址，跳过去执行。
- 动态优先级调整支持 ——> ***可重入风险？？？***
- 中断延迟大大缩短
- 中断可屏蔽 ——> 让time‐critical的任务能在deadline到来前完成，而不被干扰

## 存储器映射

不像其它的 ARM 架构，它们的存储器映射由半导体厂家说了算，Cortex‐M3 预先 定义好了“粗线条的”存储器映射。不用每学一种不同的单片机就要熟悉一种新的存储器映射。

![存储器映射](C:\Users\RSheng\Documents\Embedded-development\The Defi nitive Guide to the\存储器映射.PNG)

## 总线接口

- 指令存储区总线（两条）
- 系统总线 
- 私有外设总线

## 存储器保护单元--MPU

## 指令系统

## 中断和异常

## 调试支持

## 小节

